import{_ as U,d as G,a as A,b as C,p as E,m as F,q as N,r as m,s as P,o as q,j as I,g as a,w as l,f as z,k as D,v as L,F as O,Q as T,i as K,l as Q,x as R,y as S,z as B,A as v,u as W,B as Z,C as H,D as J,E as X}from"./entry-710cb5a5.mjs";const Y=G({__name:"edit-group-dialog",props:{group:null,name:null},emits:["ok","hide"],setup(_,{expose:n,emit:c}){n();const e=_,r=A(),d=C(),{getApproximateMembersCount:s,stripLink:f}=ae(),i=E(),o=F({name:e.group.name,link:`https://facebook.com/groups/${e.group.link}`,category:e.group.category||[],keywords:e.group.keywords?e.group.keywords.join(","):"",members:e.group.members||0,approximateMembers:s(e.group.members),canBeSent:!1,isBeingSent:!1,wasSend:!1}),u={...o},g=(y,p)=>y.length===p.length&&y.every(w=>p.includes(w));N(()=>{o.name===u.name&&o.link===u.link&&g(o.category,u.category)&&o.keywords===u.keywords&&o.members===u.members?o.canBeSent=!1:o.canBeSent=!0});function V(){o.wasSend=!1,o.isBeingSent=!0;const{name:y,link:p,category:w,keywords:x,members:j}=o;/.*facebook.com\/groups\//.test(p)||(o.canBeSent=!1),o.canBeSent&&(r.isAdmin?v(S(B(),`${e.name}/groups/${e.group.index-1}`),{name:y,link:f(p),category:w,keywords:x,members:j}).then(()=>v(S(B(),`${e.name}/lastUpdateDate`),new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"2-digit",day:"2-digit"}))).then(()=>{o.wasSend=!0,b()}):R(S(B(),"submissions"),{name:y,link:p,category:w,keywords:x,members:j}).then(()=>{o.wasSend=!0,b()}))}function k(){i.value.show()}function b(){i.value.hide()}function h(){c("hide")}const t={props:e,emits:c,user:r,sections:d,getApproximateMembersCount:s,stripLink:f,editGroupDialog:i,form:o,initialForm:u,areArraysEqual:g,submitSubmission:V,show:k,hide:b,onDialogHide:h,QDialog:T};return Object.defineProperty(t,"__isScriptSetup",{enumerable:!1,value:!0}),t}}),$=K("h6",{class:"text-center q-ma-none"}," Zaaktualizuj dane grupy ",-1),ee=K("h6",{class:"q-ma-none q-mb-md"}," Informacja ",-1),oe=Q(" Pro\u015Bba o zaaktualizowanie danych grupy zosta\u0142a pomy\u015Blnie wys\u0142ana. Zostan\u0105 one dodane w najbli\u017Cszym mo\u017Cliwym czasie. ");function ne(_,n,c,e,r,d){const s=m("q-card-section"),f=m("q-separator"),i=m("q-icon"),o=m("q-input"),u=m("q-select"),g=m("q-btn"),V=m("q-form"),k=m("q-card"),b=m("q-card-actions"),h=P("close-popup");return q(),I(O,null,[a(e.QDialog,{ref:"editGroupDialog"},{default:l(()=>[a(k,{class:"full-width"},{default:l(()=>[a(s,null,{default:l(()=>[$]),_:1}),a(f),a(V,{onSubmit:e.submitSubmission},{default:l(()=>[a(s,{class:"q-py-md q-gutter-y-lg"},{default:l(()=>[a(o,{modelValue:e.form.name,"onUpdate:modelValue":n[0]||(n[0]=t=>e.form.name=t),modelModifiers:{trim:!0},color:"secondary",disable:e.form.isBeingSent,label:"Nazwa grupy",outlined:"",required:"",square:"","stack-label":""},{append:l(()=>[a(i,{name:"segment"})]),_:1},8,["modelValue","disable"]),a(o,{modelValue:e.form.link,"onUpdate:modelValue":n[1]||(n[1]=t=>e.form.link=t),modelModifiers:{trim:!0},"hide-bottom-space":"",error:!/facebook.com\/groups\/[A-Za-z0-9+]/.test(e.form.link),"error-message":"Nieprawid\u0142owy link do grupy.",color:"secondary",disable:e.form.isBeingSent,label:"Link do grupy",outlined:"",required:"",square:"","stack-label":"",onError:n[2]||(n[2]=t=>e.form.canBeSent=!1)},{append:l(()=>[a(i,{name:"link"})]),_:1},8,["modelValue","error","disable"]),c.name.startsWith("sections")?(q(),z(u,{key:0,modelValue:e.form.category,"onUpdate:modelValue":n[3]||(n[3]=t=>e.form.category=t),color:"secondary",disable:e.form.isBeingSent,label:"Kategorie",multiple:"",options:e.sections.categories,"options-dense":"","options-selected-class":"text-secondary",outlined:"",square:"","stack-label":""},null,8,["modelValue","disable","options"])):D("",!0),c.name.startsWith("sections")?(q(),z(o,{key:1,modelValue:e.form.keywords,"onUpdate:modelValue":n[4]||(n[4]=t=>e.form.keywords=t),modelModifiers:{trim:!0},color:"secondary",disable:e.form.isBeingSent,hint:"Je\u015Bli nazwa twojej grupy lub link do niej nie jest oczywisty, dodaj s\u0142owa kluczowe, aby mo\u017Cna by\u0142o po nich j\u0105 wyszuka\u0107.",label:"S\u0142owa kluczowe",outlined:"",square:"","stack-label":"","hide-bottom-space":""},{append:l(()=>[a(i,{name:"list"})]),_:1},8,["modelValue","disable"])):D("",!0),a(o,{modelValue:e.form.members,"onUpdate:modelValue":n[5]||(n[5]=t=>e.form.members=t),modelModifiers:{number:!0},color:"secondary",disable:e.form.isBeingSent,label:"Liczba cz\u0142onk\xF3w",outlined:"",square:"","stack-label":"",onInput:n[6]||(n[6]=t=>e.form.approximateMembers=e.getApproximateMembersCount(e.form.members))},null,8,["modelValue","disable"]),a(o,{modelValue:e.form.approximateMembers,"onUpdate:modelValue":n[7]||(n[7]=t=>e.form.approximateMembers=t),color:"secondary",disable:"",label:"Orientacyjna liczba cz\u0142onk\xF3w",outlined:"",square:"","stack-label":""},null,8,["modelValue"])]),_:1}),a(f),a(s,{class:"flex justify-end"},{default:l(()=>[a(g,{color:"secondary",disable:e.form.isBeingSent||!e.form.canBeSent,flat:"",label:"Wy\u015Blij",loading:e.form.isBeingSent,type:"submit"},null,8,["disable","loading"])]),_:1})]),_:1})]),_:1})]),_:1},512),e.user.isAdmin?D("",!0):(q(),z(e.QDialog,{key:0,modelValue:e.form.wasSend,"onUpdate:modelValue":n[8]||(n[8]=t=>e.form.wasSend=t)},{default:l(()=>[a(k,null,{default:l(()=>[a(s,null,{default:l(()=>[ee]),_:1}),a(s,{class:"q-pt-none"},{default:l(()=>[oe]),_:1}),a(b,{align:"right"},{default:l(()=>[L(a(g,{color:"secondary",flat:"",label:"OK"},null,512),[[h]])]),_:1})]),_:1})]),_:1},8,["modelValue"]))],64)}var M=U(Y,[["render",ne]]),re=Object.freeze(Object.defineProperty({__proto__:null,default:M},Symbol.toStringTag,{value:"Module"}));function ae(){function _(r){const d=[[0,100,"0+"],[101,500,"100+"],[501,1e3,"500+"],[1001,2500,"1K+"],[2501,5e3,"2.5K+"],[5001,1e4,"5K+"],[10001,25e3,"10K+"],[25001,5e4,"25K+"],[50001,75e3,"50K+"],[75001,1e5,"75K+"],[100001,15e4,"100K+"],[150001,2e5,"150K+"],[200001,1/0,"250K+"]];return r?d.find(s=>r>=s[0]&&r<=s[1])[2]:"0+"}function n(r,d){const s=W(),f=(r==="sections"?C().groups:Z().groups).filter(o=>o.link!==d),i={name:r,lastUpdateDate:new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),groups:f};H(S(B(J()),`${r==="sections"?s.public.sectionsPath:s.public.taggroupsPath}`),i)}function c(r){return new URL(r).pathname.split("/")[2]}function e(r,d){X.create({component:M,componentProps:{name:d,group:r}})}return{getApproximateMembersCount:_,deleteGroup:n,stripLink:c,showEditGroupDialog:e}}export{re as e,ae as u};
